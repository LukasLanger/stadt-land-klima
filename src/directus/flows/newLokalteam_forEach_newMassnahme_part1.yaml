name: newLokalteam_forEach_newMassnahme_part1
icon: bolt
color: null
description: triggers createsBewrtung Flow when creating a lokalteam gets
  created for each Massnahme there is
status: active
trigger: event
accountability: all
options:
  type: action
  scope:
    - items.create
  collections:
    - lokalteam
    - localteams
operations:
  - name: Trigger Flow
    key: trigger_l4vib
    type: trigger
    position_x: 29
    position_y: 20
    options:
      flow: 5afc19fc-f9c8-441c-98e9-89efeb680093
      payload: "{{ $last.retData }}"
  - name: Read Data
    key: item_read_cwbfe
    type: item-read
    position_x: 19
    position_y: 1
    options:
      collection: measures
      query: null
    resolve_key: exec_33st5
  - name: add_localteam_id
    key: exec_33st5
    type: exec
    position_x: 37
    position_y: 1
    options:
      code: |2-
         module.exports = async function(data) {
                    let retData = data["$last"]
                	for (var i = 0; i < retData.length; i++){
                  		retData[i]["localteam_id"]=data["$trigger"]["key"]
                        retData[i]["measure_id"]=retData[i]["id"]
                  	}
                    return {retData};
                }
    resolve_key: trigger_l4vib
operation_key: item_read_cwbfe
