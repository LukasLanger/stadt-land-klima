var t={id:"updateRanks",handler:({},{database:t,logger:e})=>{t.raw("WITH RankedScores AS ( \t\t\tSELECT \t\t\tid, \t\t\tDENSE_RANK() OVER (ORDER BY score_total DESC) AS place \t\t\tFROM \t\t\tpublic.municipalities \t\t\tWHERE status='published' \t\t) \t\t\t\t\tUPDATE public.municipalities AS t \t\t\tSET place = ( \t\t\t\tCASE \t\t\t\t\tWHEN t.status = 'published' THEN ( \t\t\t\t\t\tSELECT r.place \t\t\t\t\t\tFROM RankedScores r \t\t\t\t\t\tWHERE t.id = r.id \t\t\t\t\t) \t\t\t\t\tELSE -1 \t\t\t\tEND \t\t\t); \t\t").then((t=>{e.info(t,"resultsDB")})).catch((t=>{throw e.info(t,"error pushing DB"),new t}))}};export{t as default};
